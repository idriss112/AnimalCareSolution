@using Microsoft.AspNetCore.Identity
@inject UserManager<ApplicationUser> UserManager

@{
    ViewData["Title"] = "Home";
    var userName = User.Identity.IsAuthenticated ? User.Identity.Name : "Guest";
}

<div class="container mt-4">

    @* ===================== PUBLIC (NOT LOGGED IN) ===================== *@
    @if (!User.Identity.IsAuthenticated)
    {
        <div class="text-center mt-5">
            <h1 class="display-5 fw-bold">🐾 Welcome to Animal Care Clinic</h1>
            <p class="lead mt-3">
                A complete veterinary management system.
                Book appointments, manage animals, and keep medical history organized.
            </p>

            <a asp-area="Identity" asp-page="/Account/Login" class="btn btn-primary btn-lg mt-3">
                Login
            </a>
            <a asp-area="Identity" asp-page="/Account/Register" class="btn btn-outline-primary btn-lg mt-3 ms-2">
                Register
            </a>
        </div>

        <hr class="my-5" />
        <div class="row text-center">
            <div class="col-md-4">
                <i class="bi bi-calendar2-check display-4 text-primary"></i>
                <h4 class="mt-3">Online Appointments</h4>
                <p>Book appointments with our veterinarians easily.</p>
            </div>
            <div class="col-md-4">
                <i class="bi bi-heart-pulse display-4 text-danger"></i>
                <h4 class="mt-3">Animal Records</h4>
                <p>Store medical history, treatments, and more.</p>
            </div>
            <div class="col-md-4">
                <i class="bi bi-people display-4 text-success"></i>
                <h4 class="mt-3">Owner Management</h4>
                <p>Keep all owners and pets organized in one place.</p>
            </div>
        </div>

        <div class="my-5"></div>
        return;
    }

    @* ===================== LOGGED-IN SECTION ===================== *@

    <h2 class="fw-bold mb-4">Welcome, @userName 👋</h2>

    @* ===================== ADMIN DASHBOARD ===================== *@
    @if (User.IsInRole("Admin"))
    {
        <div class="row g-4">

            <div class="col-md-3">
                <div class="card shadow stat-card bg-primary text-white">
                    <div class="card-body text-center">
                        <i class="bi bi-people display-6"></i>
                        <h5 class="mt-2">Owners</h5>
                        <h2>@ViewBag.TotalOwners</h2>
                        <a asp-controller="Owners" asp-action="Index" class="text-white">View all →</a>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <div class="card shadow stat-card bg-success text-white">
                    <div class="card-body text-center">
                        <i class="bi bi-heart display-6"></i>
                        <h5 class="mt-2">Animals</h5>
                        <h2>@ViewBag.TotalAnimals</h2>
                        <a asp-controller="Animals" asp-action="Index" class="text-white">View all →</a>
                    </div>
                </div>
            </div>

            <div class="col-md-3">
                <div class="card shadow stat-card bg-info text-white">
                    <div class="card-body text-center">
                        <i class="bi bi-person-badge display-6"></i>
                        <h5 class="mt-2">Veterinarians</h5>
                        <h2>@ViewBag.TotalVets</h2>
                        <a asp-controller="Veterinarians" asp-action="Index" class="text-white">View all →</a>
                    </div>
                </div>
            </div>

            <!-- ✅ CHANGED: Receptionists instead of Appointments Today -->
            <div class="col-md-3">
                <div class="card shadow stat-card bg-warning text-dark">
                    <div class="card-body text-center">
                        <i class="bi bi-person-workspace display-6"></i>
                        <h5 class="mt-2">Receptionists</h5>
                        <h2>@ViewBag.TotalReceptionists</h2>
                        <a asp-controller="Receptionists" asp-action="Index" class="text-dark">View all →</a>
                    </div>
                </div>
            </div>
        </div>

        <hr class="my-5" />

        <div class="card shadow">
            <div class="card-header bg-light">
                <h4 class="mb-0">Quick Actions</h4>
            </div>
            <div class="card-body">
                <a asp-controller="Owners" asp-action="Create" class="btn btn-primary me-2">
                    <i class="bi bi-person-plus"></i> Add Owner
                </a>
                <a asp-controller="Animals" asp-action="Create" class="btn btn-success me-2">
                    <i class="bi bi-plus-circle"></i> Add Animal
                </a>
                <a asp-controller="Veterinarians" asp-action="Create" class="btn btn-info me-2">
                    <i class="bi bi-person-badge"></i> Add Vet
                </a>
                <!-- ✅ ADDED: Add Receptionist button -->
                <a asp-controller="Receptionists" asp-action="Create" class="btn btn-warning text-dark me-2">
                    <i class="bi bi-person-plus"></i> Add Receptionist
                </a>
                <a asp-controller="Appointments" asp-action="Create" class="btn btn-warning text-dark me-2">
                    <i class="bi bi-calendar-plus"></i> Book Appointment
                </a>
                <a asp-controller="Admin" asp-action="MonthlyReport" class="btn btn-dark">
                    <i class="bi bi-graph-up"></i> Monthly Report
                </a>
            </div>
        </div>

        return;
    }

    @* ===================== VETERINARIAN HOME ===================== *@
    @if (User.IsInRole("Veterinarian"))
    {
        <div class="row">

            <div class="col-md-6">
                <div class="card shadow mb-4">
                    <div class="card-body text-center">
                        <i class="bi bi-calendar-event display-5 text-primary"></i>
                        <h4 class="mt-3">My Appointments</h4>
                        <p class="text-muted">Review and complete your appointments.</p>
                        <a asp-controller="Appointments" asp-action="MyAppointments" class="btn btn-primary">
                            View My Appointments →
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card shadow mb-4">
                    <div class="card-body text-center">
                        <i class="bi bi-clock-history display-5 text-success"></i>
                        <h4 class="mt-3">My Schedule</h4>
                        <p class="text-muted">View your weekly schedule.</p>
                        <a asp-controller="VetSchedules" asp-action="MySchedule" class="btn btn-success">
                            View My Schedule →
                        </a>
                    </div>
                </div>
            </div>

        </div>

        return;
    }

    @* ===================== RECEPTIONIST HOME ===================== *@
    @if (User.IsInRole("Receptionist"))
    {
        <div class="row">

            <div class="col-md-6">
                <div class="card shadow mb-4">
                    <div class="card-body text-center">
                        <i class="bi bi-calendar-plus display-5 text-primary"></i>
                        <h4 class="mt-3">Book Appointment</h4>
                        <a asp-controller="Appointments" asp-action="Create" class="btn btn-primary">
                            Book Now →
                        </a>
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card shadow mb-4">
                    <div class="card-body text-center">
                        <i class="bi bi-calendar2-event display-5 text-success"></i>
                        <h4 class="mt-3">Today's Schedule</h4>
                        <a asp-controller="Appointments" asp-action="TodaysSchedule" class="btn btn-success">
                            View Schedule →
                        </a>
                    </div>
                </div>
            </div>

        </div>
    }

</div>
